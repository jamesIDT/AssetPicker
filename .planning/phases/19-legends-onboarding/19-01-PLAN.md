---
phase: 19-legends-onboarding
plan: 01
type: execute
---

<objective>
Replace large inline chart legends with a collapsible "How to Read" panel and minimal icon reference.

Purpose: Reduce chart clutter while preserving all legend information in an accessible location. Experienced users can collapse the panel; new users get comprehensive explanation.
Output: Clean RSI Scatter chart with minimal corner legend, collapsible panel with full legend/guide.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/17-chart-theming/17-01-SUMMARY.md
@.planning/phases/18-component-refinement/18-01-SUMMARY.md

**Key files:**
@src/charts.py - Contains build_rsi_scatter() with inline legend annotations (lines 518-583)
@app.py - Main Streamlit app, will host the collapsible panel

**Tech stack available:** Streamlit expanders, CSS tokens from Phase 15
**Established patterns:** Dark theme with cream text, expanders for secondary info (Signal Lifecycle)

**Constraining decisions:**
- Phase 16: Reserve expanders for secondary/detail information
- Phase 17: Cream text (#FFFFE3) for dark backgrounds, rgba backgrounds for panels
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove inline legend annotations from RSI Scatter</name>
  <files>src/charts.py</files>
  <action>
Delete the two large fig.add_annotation() blocks in build_rsi_scatter():
1. "Divergence Markers" legend (lines ~518-551) - the one with x=0.01, y=0.99
2. "Color mode explanation" legend (lines ~553-583) - the one with x=0.01, y=0.01

Keep the quadrant labels (Capitulation, Peak Momentum, etc.) as they're part of the chart visualization, not legend clutter.
  </action>
  <verify>Run `python -c "from src.charts import build_rsi_scatter; print('OK')"` - no import errors</verify>
  <done>Both inline legend annotations removed from build_rsi_scatter(), chart builds without errors</done>
</task>

<task type="auto">
  <name>Task 2: Add minimal icon legend to RSI Scatter corner</name>
  <files>src/charts.py</files>
  <action>
Add a compact icon-only legend in the top-right corner of the chart (below the colorbar area). Use a single fig.add_annotation() with:
- Position: x=0.99, y=0.99, xanchor="right", yanchor="top"
- Content: Single line with marker symbols: "‚óè = No div  + = Bull  ‚óÜ = Bear  ‚óã = Score 2+  ‚óã‚óã = Score 4"
- Styling: Small font (9px), cream text, semi-transparent dark background, minimal padding
- Purpose: Quick reference for experienced users who know what the markers mean

Note: Color encoding (Weekly RSI or Beta Residual) is already shown in the colorbar title, so don't duplicate.
  </action>
  <verify>Run app with `streamlit run app.py`, check RSI Scatter has small corner legend</verify>
  <done>Minimal icon legend visible in top-right corner, unobtrusive but readable</done>
</task>

<task type="auto">
  <name>Task 3: Create collapsible "How to Read This Dashboard" panel</name>
  <files>app.py</files>
  <action>
Add a collapsible expander at the TOP of the dashboard (after the header, before Market Regime) with:

```python
with st.expander("üìñ How to Read This Dashboard", expanded=False):
    col1, col2 = st.columns(2)

    with col1:
        st.markdown("""
        ### RSI Scatter Chart (Left)
        **Position = Daily RSI √ó Liquidity**
        - X-axis: Daily RSI (0-100)
        - Y-axis: Volume/Market Cap ratio (log scale)

        **Quadrants:**
        - üü¢ **Capitulation** (top-left): Oversold + High Activity
        - üî¥ **Peak Momentum** (top-right): Overbought + High Activity
        - ‚¨ú **Forgotten** (bottom-left): Oversold + Low Activity
        - üü† **Quiet Pump** (bottom-right): Overbought + Low Activity

        **Color = Weekly RSI alignment**
        - Green: Weekly oversold (<30) - timeframes aligned
        - Red: Weekly overbought (>70) - timeframes aligned
        - Yellow: Neutral weekly RSI

        **Marker Shapes:**
        - ‚óè Circle: No divergence detected
        - + Cross: Bullish divergence (price lower, RSI higher)
        - ‚óÜ Diamond: Bearish divergence (price higher, RSI lower)

        **Divergence Rings:**
        - Thin ring: Score 2 (single strong signal)
        - Bold ring: Score 4 (multi-timeframe confirmation)
        """)

    with col2:
        st.markdown("""
        ### Acceleration Quadrant (Right)
        **Position = RSI Acceleration √ó Volatility**
        - X-axis: RSI velocity change (positive = accelerating up)
        - Y-axis: Volatility ratio vs 20-day average

        **Quadrants:**
        - üéØ **Coiled Spring** (bottom-right): Accelerating + Compressed ‚Üí Best entry
        - üí• **Explosive Move** (top-right): Accelerating + High Vol ‚Üí Move in progress
        - ‚ö†Ô∏è **Exhausting** (top-left): Decelerating + High Vol ‚Üí Move fading
        - üí§ **Dormant** (bottom-left): Decelerating + Compressed ‚Üí Waiting

        ### Opportunity Leaderboard
        **Score (0-5)**: Multi-factor ranking combining:
        - RSI extremity and divergence
        - Signal freshness (newer = higher)
        - Volatility compression bonus
        - Funding rate confluence

        ### Signal Lifecycle
        - **Fresh** ‚òÖ‚òÖ‚òÖ: New signal, highest conviction
        - **Confirmed** ‚òÖ‚òÖ: Sustained for 2-3 days
        - **Extended** ‚òÖ: 4+ days, may be exhausting
        - **Resolving**: Moving back toward neutral
        """)
```

Style the expander content to match dark theme using existing CSS (it should inherit from Phase 15 design system).
  </action>
  <verify>Run app, verify expander appears at top, collapses/expands correctly, content readable</verify>
  <done>Collapsible panel at top with comprehensive legend, collapsed by default, dark theme styling</done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] `streamlit run app.py` loads without errors
- [ ] RSI Scatter chart has no large inline legends (only minimal corner reference)
- [ ] "How to Read This Dashboard" expander visible at top
- [ ] Expander collapsed by default, expands to show full legend
- [ ] All legend content from removed annotations preserved in panel
- [ ] Dark theme styling consistent with rest of dashboard
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- Chart is cleaner (no blocking legend panels)
- Legend information accessible via collapsible panel
- Experienced users can work with minimal corner legend
- New users can expand panel for full context
</success_criteria>

<output>
After completion, create `.planning/phases/19-legends-onboarding/19-01-SUMMARY.md`
</output>
