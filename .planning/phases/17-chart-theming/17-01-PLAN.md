---
phase: 17-chart-theming
plan: 01
type: execute
---

<objective>
Update Plotly charts to dark theme while preserving the red-yellow-green RSI spectrum clarity.

Purpose: Charts must integrate with the dark dashboard theme (Phase 15) without compromising data readability. The RdYlGn colorscale is the PRIMARY data visualization mechanism and must remain clear against dark backgrounds.

Output: Dark-themed RSI Scatter, Acceleration Quadrant, and Sector Momentum charts that maintain data clarity.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/15-design-system/15-01-SUMMARY.md
@.planning/phases/16-layout-restructure/16-01-SUMMARY.md
@src/charts.py

**Design System Tokens (from Phase 15):**
- --bg-0: #4A4A4A (primary dark gray background)
- --bg-1: #6D8196 (slate blue for panels)
- --text-0: #FFFFE3 (cream primary text)
- --text-1: rgba(255, 255, 227, 0.72) (secondary text)
- --text-2: rgba(255, 255, 227, 0.54) (muted text)
- --accent: #FFB020 (yellow-orange accent)
- --line: rgba(255, 255, 227, 0.12) (subtle borders)

**Critical Constraint:** RdYlGn colorscale must remain highly visible. On dark backgrounds:
- Green (#4CAF50, #66BB6A) = opportunity/oversold - MUST pop
- Yellow (#FFC107, #FFEB3B) = neutral - MUST be visible
- Red (#F44336, #EF5350) = caution/overbought - MUST contrast

**Key Insight:** The RdYlGn colorscale works BETTER on dark backgrounds than on white - the colors are more vibrant and contrast is higher. The challenge is the quadrant labels, text, and chart furniture.
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update RSI Scatter chart theming</name>
  <files>src/charts.py</files>
  <action>
Update build_rsi_scatter() with dark theme styling:

1. **Chart backgrounds:**
   - paper_bgcolor: "#4A4A4A" (matches --bg-0)
   - plot_bgcolor: "rgba(90, 90, 90, 0.3)" (subtle lighter for plot area contrast)

2. **Axis styling:**
   - title color: "#FFFFE3" (cream text)
   - tickfont color: "#FFFFE3"
   - gridcolor: "rgba(255, 255, 227, 0.08)" (subtle cream grid)

3. **Quadrant shading - adjust opacity for dark mode:**
   - Top-left (Capitulation/green): rgba(76, 175, 80, 0.12) - slightly more opaque
   - Top-right (Peak Momentum/red): rgba(244, 67, 54, 0.12)
   - Bottom-left (Forgotten/gray): rgba(158, 158, 158, 0.08)
   - Bottom-right (Quiet Pump/orange): rgba(255, 152, 0, 0.12)

4. **Quadrant divider lines:**
   - Change from rgba(0,0,0,0.15) to rgba(255,255,227,0.15) (cream)

5. **Quadrant labels (large background text):**
   - Change font color from rgba(0,0,0,0.10) to rgba(255,255,227,0.08)
   - Description text: rgba(255,255,227,0.06)

6. **Data point text labels:**
   - textfont color: "#FFFFE3" (cream)

7. **Colorbar styling:**
   - tickfont color: "#FFFFE3"
   - title font color: "#FFFFE3"

8. **Legend annotations (top-left, bottom-left):**
   - bgcolor: "rgba(90, 90, 90, 0.95)" (dark panel)
   - bordercolor: "rgba(255, 255, 227, 0.2)" (cream border)
   - font color: "#FFFFE3"

9. **Marker outlines:**
   - Change from rgba(0,0,0,0.3) to rgba(255,255,255,0.4) (light outline for pop)

PRESERVE: RdYlGn_r colorscale unchanged - it naturally looks great on dark backgrounds.
  </action>
  <verify>Run app with `streamlit run app.py`, verify RSI Scatter chart has dark theme, colors are vibrant and readable.</verify>
  <done>RSI Scatter chart matches dark theme, RdYlGn spectrum is clearly visible, all text is cream-colored</done>
</task>

<task type="auto">
  <name>Task 2: Update Acceleration Quadrant chart theming</name>
  <files>src/charts.py</files>
  <action>
Update build_acceleration_quadrant() with dark theme styling (same pattern as Task 1):

1. **Chart backgrounds:**
   - paper_bgcolor: "#4A4A4A"
   - plot_bgcolor: "rgba(90, 90, 90, 0.3)"

2. **Axis styling:**
   - title color: "#FFFFE3"
   - tickfont color: "#FFFFE3"
   - gridcolor: "rgba(255, 255, 227, 0.08)"
   - zerolinecolor: "rgba(255, 255, 227, 0.15)"

3. **Quadrant shading - adjust for dark mode:**
   - Top-left (Exhausting): rgba(255, 152, 0, 0.12)
   - Top-right (Explosive): rgba(244, 67, 54, 0.12)
   - Bottom-left (Dormant): rgba(158, 158, 158, 0.10)
   - Bottom-right (Coiled Spring): rgba(76, 175, 80, 0.15) - slightly brighter for emphasis

4. **Quadrant boundary lines:**
   - Change to rgba(255, 255, 227, 0.15)

5. **Quadrant labels:**
   - Change font color to rgba(255, 255, 227, 0.10)

6. **Data point text labels:**
   - textfont color: "#FFFFE3"

7. **Colorbar styling:**
   - tickfont color: "#FFFFE3"
   - title font color: "#FFFFE3"

8. **Marker outlines:**
   - Change to rgba(255, 255, 255, 0.4)

PRESERVE: RdYlGn_r colorscale unchanged.
  </action>
  <verify>Verify Acceleration Quadrant has consistent dark theme, quadrant labels visible but subtle.</verify>
  <done>Acceleration Quadrant matches dark theme, colors align with RSI Scatter</done>
</task>

<task type="auto">
  <name>Task 3: Update Sector Momentum bar chart theming</name>
  <files>app.py</files>
  <action>
Update the Sector Momentum bar chart in app.py (around line 1238-1263) with dark theme styling:

1. **Figure layout:**
   - paper_bgcolor: "#4A4A4A"
   - plot_bgcolor: "rgba(90, 90, 90, 0.3)"

2. **Axis styling:**
   - xaxis_title_font_color: "#FFFFE3"
   - yaxis_title_font_color: "#FFFFE3"
   - xaxis_tickfont_color: "#FFFFE3"
   - yaxis_tickfont_color: "#FFFFE3"
   - xaxis_gridcolor: "rgba(255, 255, 227, 0.08)"

3. **Bar text:**
   - textfont color: "#FFFFE3"

4. **Vertical line at x=50:**
   - Change line_color from "gray" to "rgba(255, 255, 227, 0.3)"

5. **PRESERVE bar colors (already good):**
   - Green (#4CAF50) for RSI < 35
   - Red (#f44336) for RSI > 65
   - Yellow (#FFC107) for neutral
   These colors work excellently on dark backgrounds - no change needed.
  </action>
  <verify>Verify Sector Momentum chart has dark theme, bar colors remain vibrant.</verify>
  <done>Sector Momentum chart matches dark theme, green/yellow/red bars are clearly visible</done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] `streamlit run app.py` launches without errors
- [ ] RSI Scatter chart has dark background with cream text
- [ ] Acceleration Quadrant has dark background with cream text
- [ ] Sector Momentum bar chart has dark background with cream text
- [ ] RdYlGn colorscale (red-yellow-green) is CLEARLY visible on all charts
- [ ] Quadrant shading is subtle but distinguishable on dark background
- [ ] All chart text (labels, axes, legends) is readable cream color
- [ ] Charts don't "clash" with the dark Streamlit theme from Phase 15
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- RdYlGn color spectrum remains the dominant visual element on charts
- No loss of data readability compared to light theme
- Consistent dark aesthetic across all three chart types
</success_criteria>

<output>
After completion, create `.planning/phases/17-chart-theming/17-01-SUMMARY.md` with:
- YAML frontmatter (phase, plan, subsystem, tags, requires, provides, affects, tech-stack, key-files, key-decisions, patterns-established, duration, completed)
- Summary headline
- Performance metrics
- Accomplishments
- Task commits
- Files modified
- Decisions made
- Deviations (if any)
- Issues encountered
- Next phase readiness
</output>
