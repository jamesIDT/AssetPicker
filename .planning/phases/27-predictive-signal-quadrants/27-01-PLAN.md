---
phase: 27-predictive-signal-quadrants
plan: 01
type: execute
---

<objective>
Build the RSI-Price Acceleration Quadrant - a new chart that surfaces "about to pop" signals by comparing RSI acceleration to price acceleration.

Purpose: Identify coins where RSI momentum is building but price hasn't moved yet (coiled springs).
Output: New `build_rsi_price_quadrant()` function integrated into the dashboard below the existing Hero Charts row.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/27-predictive-signal-quadrants/27-CONTEXT.md

**Key insight from CONTEXT.md:** RSI often leads price. If RSI is accelerating while price is flat, something is building underneath. Distance from the diagonal parity line = signal strength.

**Existing patterns to follow:**
@src/indicators.py - `calculate_rsi_acceleration()` returns {velocity, acceleration, interpretation}
@src/charts.py - `build_acceleration_quadrant()` pattern for quadrant chart construction

**Layout pattern from app.py:**
- Hero Charts Row: chart_col1, chart_col2 = st.columns(2)
- New quadrants go below existing Hero Charts as a second row
- Use same height (550px) and modal expand pattern

**Established tech:**
- Plotly go.Figure for charts
- Dark theme colors: bg=#4A4F5E, text=#F6F8F7, accent=#B69A5A
- Batch shape updates for performance (Phase 26 lesson)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add price acceleration calculation to indicators.py</name>
  <files>src/indicators.py</files>
  <action>
Add `calculate_price_acceleration(price_history: list[float]) -> dict | None` function.

Implementation:
- Requires at least 3 prices (oldest to newest)
- Calculate velocity = (price[-1] - price[-2]) / price[-2] * 100 (percent change)
- Calculate prev_velocity = (price[-2] - price[-3]) / price[-3] * 100
- Calculate acceleration = velocity - prev_velocity
- Return {"velocity": velocity, "acceleration": acceleration, "pct_change_3d": (price[-1] - price[-3]) / price[-3] * 100}
- Return None if insufficient data

This mirrors the structure of calculate_rsi_acceleration but for price momentum.
  </action>
  <verify>python -c "from src.indicators import calculate_price_acceleration; print(calculate_price_acceleration([100, 102, 105]))"</verify>
  <done>Function returns dict with velocity, acceleration, pct_change_3d keys. Returns None for <3 prices.</done>
</task>

<task type="auto">
  <name>Task 2: Create build_rsi_price_quadrant() chart function</name>
  <files>src/charts.py</files>
  <action>
Add `build_rsi_price_quadrant(coins, height=550, timeframe=None, multi_tf_rsi=None, price_history_map=None) -> go.Figure` function.

Implementation following build_acceleration_quadrant pattern:
1. For each coin:
   - Get RSI acceleration from multi_tf_rsi or coin["acceleration"]
   - Get price acceleration from price_history_map (need to pass this)
   - Skip coins missing either value

2. Create scatter plot:
   - X-axis: RSI acceleration
   - Y-axis: Price acceleration (%)
   - Color by distance from diagonal (signal strength)

3. Add diagonal parity line (y = x scaled appropriately):
   - When RSI and price accelerate equally, they're on the diagonal
   - Points ABOVE diagonal: price leading RSI (momentum waning)
   - Points BELOW diagonal: RSI leading price (SIGNAL - about to pop)

4. Calculate "gap score" = RSI_accel - Price_accel (when RSI > price, positive = bullish signal)

5. Color scale: Points with larger positive gaps get more intense/glowing appearance (use marker size + opacity)

6. Quadrant shading (subtle):
   - Bottom-right (RSI+ / Price-): "Building" - RSI rising, price flat/falling = coiled spring
   - Top-right (RSI+ / Price+): "Confirmed" - both moving up
   - Top-left (RSI- / Price+): "Exhausting" - price still up but RSI fading
   - Bottom-left (RSI- / Price-): "Capitulating" - both falling

7. Dark theme styling matching existing charts:
   - paper_bgcolor="#4A4F5E", plot_bgcolor="#4A4F5E"
   - Font color="#F6F8F7"
   - Gridcolor with low opacity

8. Tooltip with: Symbol, RSI Accel, Price Accel, Gap Score, Interpretation

Do NOT use individual fig.add_shape() calls - collect shapes in list and use update_layout(shapes=[...]) for performance.
  </action>
  <verify>python -c "from src.charts import build_rsi_price_quadrant; print('function exists')"</verify>
  <done>Function creates Plotly figure with diagonal parity line, scatter points colored by gap score, quadrant labels, dark theme.</done>
</task>

<task type="auto">
  <name>Task 3: Integrate quadrant into dashboard layout</name>
  <files>app.py</files>
  <action>
1. Add import: `build_rsi_price_quadrant` to the charts import line

2. In the data processing section (where coin_data is built), extract price histories:
   - Create price_history_map = {}
   - For each coin, if "prices" in ohlc_history[coin_id], extract last ~10 daily prices
   - Store: price_history_map[coin_id] = [price for ts, price in prices[-10:]]

3. Calculate price acceleration for each coin and store in coin data:
   - Add to coin dict: "price_acceleration": calculate_price_acceleration(prices)

4. Add new row below Hero Charts (after chart_col2 with block, before "DIVERGENCE ANALYSIS"):

   ```python
   # Predictive Signal Row
   st.markdown(
       '<div class="section-header">PREDICTIVE SIGNALS â€” RSI vs PRICE MOMENTUM</div>',
       unsafe_allow_html=True,
   )

   pred_col1, pred_col2 = st.columns(2)

   with pred_col1:
       # Build RSI-Price quadrant
       rsi_price_fig = build_rsi_price_quadrant(
           filtered_coin_data,
           height=450,
           timeframe=st.session_state.get("show_timeframe"),
           multi_tf_rsi=st.session_state.get("multi_tf_rsi"),
           price_history_map=price_history_map,
       )
       if rsi_price_fig:
           st.plotly_chart(
               rsi_price_fig,
               use_container_width=True,
               config={"responsive": True, "displayModeBar": False},
           )
       else:
           st.info("Price acceleration data requires price history.")

   with pred_col2:
       # Placeholder for Phase 28 Signal Persistence Quadrant
       st.info("Signal Persistence Quadrant coming in Phase 28")
   ```

5. Store price_history_map in session state for potential reuse.
  </action>
  <verify>streamlit run app.py (manual check - new section appears below Hero Charts)</verify>
  <done>New "PREDICTIVE SIGNALS" row visible below Hero Charts with RSI-Price quadrant on left, placeholder on right.</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `python -c "from src.indicators import calculate_price_acceleration"` succeeds
- [ ] `python -c "from src.charts import build_rsi_price_quadrant"` succeeds
- [ ] App runs without errors: `streamlit run app.py`
- [ ] RSI-Price Quadrant chart renders with diagonal line
- [ ] Points colored by gap score (RSI accel - Price accel)
- [ ] Quadrant labels visible (Building, Confirmed, Exhausting, Capitulating)
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- No errors or warnings introduced
- RSI-Price Acceleration Quadrant displays correctly
- Diagonal parity line shows RSI vs Price relationship
- Points below diagonal (RSI leading) are visually emphasized
</success_criteria>

<output>
After completion, create `.planning/phases/27-predictive-signal-quadrants/27-01-SUMMARY.md`
</output>
