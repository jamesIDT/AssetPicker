---
phase: 18-component-refinement
plan: 01
type: execute
---

<objective>
Restyle individual UI components to match the dark theme design system established in Phase 15.

Purpose: Achieve visual consistency across all dashboard components for professional analyst aesthetic.
Output: All UI components styled with dark theme, cream text, and design tokens.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-phase.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Prior phase summaries (dependency chain):
@.planning/phases/15-design-system/15-01-SUMMARY.md
@.planning/phases/16-layout-restructure/16-01-SUMMARY.md
@.planning/phases/17-chart-theming/17-01-SUMMARY.md

# Source files:
@app.py

**Tech stack available:** CSS custom properties, Streamlit CSS injection, JetBrains Mono
**Established patterns:**
- Design tokens: --bg-0, --bg-1, --bg-2 for backgrounds; --text-0, --text-1, --text-2 for text; --accent for highlights
- Panel styling: var(--panel) with var(--line) borders, 2px border-radius
- Cream text: #FFFFE3 for primary, rgba variants for secondary/muted

**Constraining decisions:**
- Phase 15: CSS tokens in :root for theming
- Phase 17: Dark Plotly charts with cream text, rgba backgrounds

**Components to restyle:**
1. Market Regime banner (lines 843-878) - uses light backgrounds, needs dark theme
2. Opportunity Leaderboard table (lines 1057-1193) - needs visual score bars
3. Sector Momentum table (lines 1284-1295) - needs styled cells
4. Signal Lifecycle table (lines 1376-1400) - needs badge styling
5. Filter controls/selectboxes - already styled in CSS, verify appearance
</context>

<tasks>

<task type="auto">
  <name>Task 1: Restyle Market Regime banner to dark theme</name>
  <files>app.py</files>
  <action>Update the Market Regime banner (around line 843-878) to use dark theme colors:
  - Replace light backgrounds (#e8f5e9, #f1f8e9, #fff3e0, #ffebee, #fffde7) with dark theme variants
  - Use var(--bg-2) or similar dark grays as base
  - Use colored borders or subtle tints instead of light backgrounds
  - Keep emoji indicators but ensure text is cream (#FFFFE3)
  - Add subtle accent color for the current regime (bull=green tint, bear=red tint, transition=yellow-orange)

  Pattern for dark regime styling:
  - Bull regimes: background rgba(76, 175, 80, 0.15), border-left 3px solid #4CAF50
  - Bear regimes: background rgba(244, 67, 54, 0.15), border-left 3px solid #f44336
  - Transition: background rgba(255, 176, 32, 0.15), border-left 3px solid var(--accent)</action>
  <verify>Run app, refresh data, verify regime banner has dark background with colored accent border</verify>
  <done>Regime banner uses dark theme with subtle colored accents instead of light backgrounds</done>
</task>

<task type="auto">
  <name>Task 2: Add visual score bars to Opportunity Leaderboard</name>
  <files>app.py</files>
  <action>Enhance the Opportunity Leaderboard table (around lines 1159-1189) to show visual score bars:
  - Replace plain text Score column with HTML that includes a visual bar
  - Bar width proportional to score (0-5 scale, so width = score/5 * 100%)
  - Use accent color (#FFB020) for the bar fill
  - Keep numeric score visible next to bar
  - Use st.markdown with unsafe_allow_html for each row instead of st.dataframe, OR
  - Use column_config with st.column_config.ProgressColumn for the Score column

  Preferred approach: Use Streamlit's native column_config.ProgressColumn:
  ```python
  st.dataframe(
      df,
      column_config={
          "Score": st.column_config.ProgressColumn(
              "Score",
              format="%.2f",
              min_value=0,
              max_value=5,
          ),
      },
      hide_index=True,
      use_container_width=True,
  )
  ```

  This requires changing Score column to numeric float instead of formatted string.</action>
  <verify>Run app, check leaderboard shows progress bars in Score column</verify>
  <done>Score column displays visual progress bar with numeric value</done>
</task>

<task type="auto">
  <name>Task 3: Style Signal Lifecycle table with conviction badges</name>
  <files>app.py</files>
  <action>Enhance Signal Lifecycle display (around lines 1376-1400):
  - Add CSS classes for conviction levels in the existing design system CSS block
  - Style conviction stars with colors: ★★★ = gold (#FFB020), ★★ = silver (#CBCBCB), ★ = muted
  - Add background color tints to rows based on signal type (green tint for oversold, red for overbought)
  - Use column_config to format the Conviction column with custom styling if possible

  Add to CSS block:
  ```css
  .conviction-high { color: var(--accent) !important; }
  .conviction-med { color: #CBCBCB !important; }
  .conviction-low { color: var(--text-2) !important; }
  ```

  For the dataframe, since we can't apply per-cell CSS easily, consider:
  - Using Styler with st.dataframe (limited support)
  - Or keeping the star display but ensuring it's visible on dark background</action>
  <verify>Run app, expand Signal Lifecycle, verify conviction stars are visible and styled appropriately</verify>
  <done>Signal Lifecycle table has properly visible conviction badges on dark theme</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `streamlit run app.py` starts without errors
- [ ] Market Regime banner displays with dark background and accent borders
- [ ] Opportunity Leaderboard shows visual score bars
- [ ] Signal Lifecycle conviction badges are visible on dark background
- [ ] All text remains cream-colored (#FFFFE3) for readability
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- No Python errors or warnings
- Components visually match dark theme aesthetic
- Consistent use of design tokens
</success_criteria>

<output>
After completion, create `.planning/phases/18-component-refinement/18-01-SUMMARY.md`
</output>
