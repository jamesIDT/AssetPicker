---
phase: 11-signal-lifecycle
plan: 01
type: execute
---

<objective>
Create a Signal Lifecycle Display showing coins with extreme RSI, their lifecycle stage, volatility context, and combined interpretation.

Purpose: Help identify highest-conviction opportunities by combining signal freshness with volatility compression.
Output: New expandable section in app.py with lifecycle table, volatility context, and badge explanations.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md

**Prior phase context:**
@.planning/phases/07-data-layer-extensions/07-04-SUMMARY.md

**Available indicator functions (already implemented in Phase 7):**
- `classify_signal_lifecycle(rsi_history, extreme_threshold, is_oversold)` ‚Üí {state, days_in_zone, entry_rsi, current_rsi, emoji}
- `detect_volatility_regime(price_history, period)` ‚Üí {regime, ratio, atr, average_atr}

**Key files:**
@src/indicators.py - Contains lifecycle and volatility functions
@src/charts.py - Chart building patterns
@app.py - Main Streamlit app with data fetching

**Roadmap spec for Phase 11:**
1. Signal Lifecycle Table showing: lifecycle stage badge (üÜï Fresh, ‚úì Confirmed, ‚è≥ Extended, ‚Üó Resolving), days in zone, price change since signal, mean reversion probability
2. Volatility Context Column (‚ö° Compressed, üåä High Vol)
3. Combined Interpretation (Fresh + Compressed = highest conviction)
4. Explanatory UI for badge meanings

**Patterns from existing code:**
- Use `st.expander()` for collapsible sections
- Use `st.dataframe()` or `st.table()` for tabular data
- Follow existing data fetching pattern in fetch_all_data()
</context>

<tasks>

<task type="auto">
  <name>Task 1: Extend data fetching for lifecycle and volatility</name>
  <files>app.py</files>
  <action>
In fetch_all_data():
1. Import classify_signal_lifecycle, detect_volatility_regime from src.indicators
2. For each coin in the result loop, after calculating RSI:
   - Call classify_signal_lifecycle() with daily RSI history, threshold 30 for oversold signals
   - Call classify_signal_lifecycle() with daily RSI history, threshold 70 for overbought signals
   - Call detect_volatility_regime() with daily price closes
3. Store lifecycle and volatility data in the coin dict:
   - `lifecycle_oversold`: lifecycle result for oversold check
   - `lifecycle_overbought`: lifecycle result for overbought check
   - `volatility`: volatility regime result
   - `price_at_signal`: price when signal started (calculate from entry_rsi's position in history)

Also calculate price_change_pct since signal started by tracking the price when RSI first entered extreme zone.

Note: The rsi_history from get_rsi_history() is already calculated for divergence detection - reuse it for lifecycle classification.
  </action>
  <verify>App still loads without errors. Check console for no import errors.</verify>
  <done>Each coin dict includes lifecycle_oversold, lifecycle_overbought, volatility, and price_change_pct fields</done>
</task>

<task type="auto">
  <name>Task 2: Create Signal Lifecycle Table section</name>
  <files>app.py</files>
  <action>
After the existing opportunity lists section, add a new expander section:

```python
with st.expander("üìä Signal Lifecycle Analysis", expanded=False):
```

Inside the expander:
1. Filter coins to those with active lifecycle signals (lifecycle_oversold.state != "none" OR lifecycle_overbought.state != "none")
2. Build a table with columns:
   - Symbol (coin symbol)
   - Signal Type (üü¢ Oversold / üî¥ Overbought)
   - Stage (emoji + state name from lifecycle)
   - Days (days_in_zone)
   - Price Change (% change since signal, green if favorable direction)
   - Volatility (‚ö° Compressed / ‚ûñ Normal / üåä Expanded from volatility regime)
   - Conviction (‚òÖ‚òÖ‚òÖ if fresh+compressed, ‚òÖ‚òÖ if confirmed+compressed or fresh+normal, ‚òÖ otherwise)

3. Sort table by conviction (highest first), then by days_in_zone (ascending for fresh signals)

4. Use st.dataframe() with column_config for emoji rendering and color formatting

If no signals are active, show: "No extreme RSI signals currently active."
  </action>
  <verify>Run app, refresh data, check that Signal Lifecycle Analysis expander appears and shows coins with extreme RSI</verify>
  <done>Expander shows table of coins with lifecycle stages, volatility context, and conviction rating</done>
</task>

<task type="auto">
  <name>Task 3: Add explanatory legend</name>
  <files>app.py</files>
  <action>
At the bottom of the Signal Lifecycle expander, add a small legend explaining the badges:

```python
st.caption("""
**Signal Stages:** üÜï Fresh (1-2 days) | ‚úì Confirmed (3-5 days) | ‚è≥ Extended (6+ days) | ‚Üó‚Üò Resolving (exiting zone)

**Volatility:** ‚ö° Compressed (coiled spring) | ‚ûñ Normal | üåä Expanded (volatile)

**Conviction:** ‚òÖ‚òÖ‚òÖ Fresh + Compressed = Highest conviction | ‚òÖ‚òÖ Confirmed or Fresh + Normal | ‚òÖ Other
""")
```

Keep it concise - single caption block with pipe separators.
  </action>
  <verify>Legend displays correctly below the table</verify>
  <done>Users understand what each badge and rating means</done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] `streamlit run app.py` loads without errors
- [ ] Refresh button still works
- [ ] Signal Lifecycle Analysis expander appears below opportunity lists
- [ ] Coins with RSI < 30 or RSI > 70 appear in the lifecycle table
- [ ] Lifecycle stages display correctly (fresh/confirmed/extended/resolving)
- [ ] Volatility context shows for each coin
- [ ] Conviction rating calculated correctly (fresh+compressed = ‚òÖ‚òÖ‚òÖ)
- [ ] Legend explains all badges
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- No new errors or warnings
- Users can see signal freshness and volatility context at a glance
- Highest conviction opportunities (fresh + compressed) are easily identifiable
</success_criteria>

<output>
After completion, create `.planning/phases/11-signal-lifecycle/11-01-SUMMARY.md`
</output>
